=== WP Malware Scanner ===
Contributors: Joshua Garza
Tags: Malware Scanner, Security
Requires at least: 5.0
Tested up to: 6.6
Requires PHP: 7.4
Stable tag: 1.0.4
License: GPLv2 or later
License URI: https://www.joshualeegarza.com

== Description ==

Purpose:
WP Malware Scanner is a lightweight security plugin designed to scan WordPress installations for suspicious code patterns, including obfuscated JavaScript, unauthorized external script loading, and malicious PHP functions commonly used in malware attacks like SocGholish. The plugin automatically scans the site every 48 hours and emails an administrator with a detailed report of any detected suspicious files. It can also be run manually from the WordPress admin dashboard.

Features:
- Automatically scans for malware every 48 hours.
- Detects common JavaScript and PHP injection patterns used in malicious attacks (e.g., eval(), base64_decode(), external scripts).
- Manually trigger scans from the WordPress admin dashboard.
- Sends detailed email reports with suspicious file paths and problematic lines of code.
- No automatic remediationâ€”ensures you retain control over the handling of flagged files.

Usage:
1. Install and activate the plugin from the WordPress admin dashboard.
2. Navigate to **Tools > Malware Scanner** to manually run a scan.
3. The plugin automatically scans your WordPress site every 48 hours and emails the results to the site administrator.
4. Review the email report or the scan results in the dashboard to identify any suspicious code for further inspection.

== Installation ==

1. Upload the `wp-malware-scanner` folder to the `/wp-content/plugins/` directory.
2. Activate the plugin through the 'Plugins' menu in WordPress.
3. Navigate to **Tools > Malware Scanner** to initiate a manual scan or wait for the automatic scan to run every 48 hours.

== Frequently Asked Questions ==

= What kind of malware can this plugin detect? =
WP Malware Scanner is designed to detect common patterns associated with malicious JavaScript and PHP code, such as obfuscated JavaScript, malicious PHP `eval()` statements, and unauthorized external script injections. While it can catch many common types of malware, it is not guaranteed to detect all forms of attacks, especially if the attacker uses advanced obfuscation techniques.

= Does the plugin automatically remove or fix malware? =
No, the plugin does not modify any files automatically. It only detects and reports suspicious files. The site administrator will need to review the flagged files and decide how to handle them.

= How does the automatic scan work? =
The plugin uses WordPress's WP-Cron system to schedule a scan every 48 hours. The results of each scan are emailed to the site administrator, providing a detailed list of suspicious files and the specific lines of code that triggered the detection.

= Can I whitelist certain files or patterns? =
This version of the plugin does not currently support whitelisting. If you encounter false positives or want to exclude certain files, you will need to modify the detection patterns in the plugin code.

== Changelog ==

= 1.0.0 =
* Initial release of WP Malware Scanner with automatic scanning and email reporting features.
= 1.0.1 =
* Added functionality in UI to define email to send reports to. If email fails, fallback email is sent to admin email.
= 1.0.2 =
* Added AJAX and UI features in addition to cutting back on false positives. Also added more readable email formats.
= 1.0.3 =
* Drilling down on false positives and fixing email deliverability
= 1.0.4 =
* Email deliverability and false positives resolved - drilling down on readability of results and email
= 1.0.5 =
* Working on false negatives